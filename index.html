<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>doragonabe site</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <!--
    <meta name="description" content="test">
    <meta name="keywords" content="test1,test2,test3">
    -->

    <meta content="noindex,nofollow,noarchive" name="robots">

    <meta http-equiv="Content-Security-Policy" content="default-src *; script-src-elem *; style-src-attr *;">
    <meta name="referrer" content="noreferrer">

    <link href="css/reset.css" rel="stylesheet">

    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/jquery-migrate-3.3.2.min.js"></script>

    <link href="js/slick/slick.css" rel="stylesheet">
    <link href="js/slick/slick-theme.css" rel="stylesheet">
    <script src="js/slick/slick.min.js"></script>

    <link href="js/mmenu/mmenu.css" rel="stylesheet">
    <script src="js/mmenu/mmenu.js"></script>

    <link href="css/style.css" rel="stylesheet">
    <link href="css/craft.css" rel="stylesheet">

    <script>
        $.ajaxSetup({
            cache: false,
            //cache: true,
        });

        $(function () {
            $('#main').load('main/top.html?ver=1.0');
        });

        function link_top() {
            $('#main').load('main/top.html?ver=1.0');
        }

        function link_server_rules() {
            $('#main').load('main/server_rules.html?ver=1.0');
        }

        function link_server_introduction() {
            $('#main').load('main/server_introduction.html?ver=1.0');
        }

        function link_server_specifications() {
            $('#main').load('main/server_specifications.html?ver=1.0');
        }

        function link_q_and_a() {
            $('#main').load('main/q_and_a.html?ver=1.0');
        }

        function link_unique_function() {
            $('#main').load('main/unique_function.html?ver=1.0');
        }

        function link_original_recipes() {
            $('#main').load('main/original_recipes.html?ver=1.0');
        }

    </script>

    <script>
        $(function () {
            $('.your-class').slick({
                accessibility: false,
                arrows: false,
                autoplay: true,
                fade: true,
            });
        });

        var $test = true;
        console.log('yyyyy')

        var lastScrollTop = 0;
        //var scrollUpFlag = false;
        $(window).scroll(function() {
          var st = $(this).scrollTop();

          var $window = $(window);
          var $menu = $('.sticky');

          if ($menu.height() > $window.height()) {
            console.log('aaaaa')


            console.log('$(this).scrollTop() + 20');
            console.log($(this).scrollTop() + 20);

            console.log('$menu.offset().top');
            console.log($menu.offset().top);

            console.log('$menu.height()');
            console.log($menu.height());

            console.log('$window.height()');
            console.log($window.height());

            console.log('$(\'header\').height()');
            console.log($('header').height());

            console.log('parseInt($(\'#main\').css(\'margin-top\'), 10)');
            console.log(parseInt($('#main').css('margin-top'), 10));


            console.log('');
            console.log('');





            if ($(this).scrollTop() + 20 >= $menu.offset().top && $test) {
              $test = false;
              //scrollUpFlag = true;

              console.log('bbbbb')


              $menu.css({
                position: 'relative',
                top: 0,

                //top: $header.height() + $menu.height() - $window.height() + 'px',
                //top: $header.height() + 'px',
                //top: $(this).scrollTop() + 20 + 'px',
                //'align-self': 'flex-start',
                //'align-self': 'flex-end',

              });
            }

            /*
            console.log('llllll')
            console.log($menu.height())
            console.log($window.height())
            console.log($menu.offset().top)
            console.log($(this).scrollTop())

             */

            if (lastScrollTop < st && $menu.height() - $window.height() + $menu.offset().top < $(this).scrollTop()) {
              console.log('ppppppp')

              //scrollUpFlag = true;

              $menu.css({
                position: 'sticky',
                top: '-' + ($menu.height() + 20 - $window.height()) + 'px',
              });

            }

            /*
            if ($(this).scrollTop() + 20 > $window.height()) {
              console.log('uuuu')

              $menu.css({
                position: 'sticky',
                top: '-' + ($menu.height() + 20 - $window.height()) + 'px',

                //top: $header.height() + $menu.height() - $window.height() + 'px',
                //top: $header.height() + 'px',
                //top: $(this).scrollTop() + 20 + 'px',
                //'align-self': 'flex-start',
                //'align-self': 'flex-end',
              });
            }
             */

            //if ($('#foo').css('display') === 'sticky') {


            //if (lastScrollTop > st && scrollUpFlag === 'sticky') {
            if (lastScrollTop > st && $menu.css('position') === 'sticky') {
              console.log('fffffff')

              //scrollUpFlag = false;

              $menu.css({
                position: 'relative',

                //top: '-' + ($menu.height() + 20 - $window.height()) + 'px',
                //top: $window.height() - $(this).scrollTop() + $menu.offset().top + 'px',
                //top: $(this).scrollTop() - $menu.offset().top + $menu.height() - $window.height() + 'px',
                //top: $menu.height() - $window.height() + 'px',
                //top: $menu.height() - $window.height() + $('header').height() + 'px',
                //top: $menu.offset().top - $(this).scrollTop() + 'px',
                //top: $(this).scrollTop() - $menu.height() - $window.height() + 'px',
                //top: $(this).scrollTop() + 'px',

                //top: lastScrollTop - $menu.height() + 'px',
                top: lastScrollTop - $menu.height() + parseInt($('#main').css('margin-top'), 10) + 20 + 12 + 'px',


                //top: $header.height() + $menu.height() - $window.height() + 'px',

                //top: $header.height() + 'px',

                //top: $(this).scrollTop() + 20 + 'px',
              });
            }

          }
          lastScrollTop = st;
        });


        $(document).ready( function () {
          //var $window = $(window);
          //var $main = $('#main');

          //var $header = $('header');

          //var $menu = $('.sticky');

          /*
          if ($main.height() < $window.height()) {
            $main.css({
              top: '60px',
              'align-self': 'flex-start'
            });
          }

           */
          //console.log(document.documentElement.scrollTop)


          //console.log($header.height())

          //console.log($menu.height())
          //console.log($window.height())

          //if ($menu.height() > $window.height()) {
            //console.log('aaaaa')

            //$menu.css({
              //position: 'absolute',
              //top: $header.height() + $menu.height() - $window.height() + 'px',
              //top: $header.height() + 'px',
              //'align-self': 'flex-start',
              //'align-self': 'flex-end',
            //});
          //}
        });
    </script>

    <script>
      document.addEventListener(
        'DOMContentLoaded', () => {
          new Mmenu('#menu', {
            extensions: [
              'position-right',
            ],
          });
        }
      );
    </script>

</head>

<body class="home">

<div id="page">
    <div id="header">
        <a href="#menu" class="close" id="menubar_hdr"></a>
    </div>

    <div class="content">
        <div id="container">
            <header>
                <h1 id="sub_title">
                    <a href="javascript:" onclick="link_top()">
                        <img alt="top" src="images/logo.png">
                    </a>
                </h1>
            </header>

            <div id="contents">
                <div id="sub">
                    <div class="sticky" style="top: 20px;">
                    <nav id="menubar">
                        <ul class="submenu">
                            <li>
                                <button onclick="link_top()" type="button">
                                    トップ<span>Top</span>
                                </button>
                            </li>
                            <li>
                                <button onclick="link_server_rules()" type="button">
                                    サーバールール<span>Server Rules</span>
                                </button>
                            </li>
                            <li>
                                <button onclick="link_server_introduction()" type="button">
                                    サーバー紹介<span>Server Introduction</span>
                                </button>
                            </li>
                            <li>
                                <button onclick="link_server_specifications()" type="button">
                                    サーバー仕様<span>Server Specifications</span>
                                </button>
                            </li>
                            <li>
                                <button onclick="link_q_and_a()" type="button">
                                    Q & A<span>Q & A</span>
                                </button>
                            </li>
                        </ul>
                    </nav>

                    <ul class="submenu">
                        <li>
                            <a href="http://takaty921.mydns.jp:8123/" target="_blank" rel="noopener noreferrer">
                                dynmap<br>※外部リンク
                            </a>
                        </li>
                        <li>
                            <button onclick="link_unique_function()" type="button">独自機能</button>
                        </li>
                        <li>
                            <button onclick="link_original_recipes()" type="button">独自レシピ</button>
                        </li>
                    </ul>
                    </div>
                </div>

                <div id="main">
                </div>
            </div>

            <div class="mainimg">
                <div class="your-class">
                    <div><img alt="" src="images/minecraft1.png"></div>
                    <div><img alt="" src="images/minecraft2.png"></div>
                    <div><img alt="" src="images/minecraft3.png"></div>
                </div>
                <div class="mask"><img alt="" src="images/123_kazari1.png"></div>
            </div>
        </div>

        <!--
        <p class="nav-fix-pos-pagetop"><a href="#"><img src="images/pagetop.png" alt="PAGE TOP"></a></p>
        -->
    </div>
</div>

<!-- モバイル用 -->
<nav id="menu">
    <ul>
        <li><a href="#page" onclick="return link_top()">トップ</a></li>
        <li><a href="#page" onclick="return link_server_rules()">サーバールール</a></li>
        <li><a href="#page" onclick="return link_server_introduction()">サーバー紹介</a></li>
        <li><a href="#page" onclick="return link_server_specifications()">サーバー仕様</a></li>
        <li><a href="#page" onclick="return link_q_and_a()">Q & A</a></li>
    </ul>
</nav>

</body>
</html>
